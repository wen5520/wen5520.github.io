<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建第一个vite项目 vite | 木子吻雨叚</title>
    <meta name="description" content="iskeys.cn">
    <link rel="icon" href="/img/logo.ico">
    
    <link rel="preload" href="/assets/css/0.styles.8d0c462e.css" as="style"><link rel="preload" href="/assets/js/app.7f183510.js" as="script"><link rel="preload" href="/assets/js/2.3fefde55.js" as="script"><link rel="prefetch" href="/assets/js/10.251486e0.js"><link rel="prefetch" href="/assets/js/11.e8908a0e.js"><link rel="prefetch" href="/assets/js/12.879eb889.js"><link rel="prefetch" href="/assets/js/13.2be19de1.js"><link rel="prefetch" href="/assets/js/14.a780330c.js"><link rel="prefetch" href="/assets/js/15.e1c8d9e7.js"><link rel="prefetch" href="/assets/js/16.5680ba47.js"><link rel="prefetch" href="/assets/js/17.28b0e132.js"><link rel="prefetch" href="/assets/js/18.cbb8c1a6.js"><link rel="prefetch" href="/assets/js/19.4b0422f8.js"><link rel="prefetch" href="/assets/js/20.d46eeaee.js"><link rel="prefetch" href="/assets/js/21.9fb7b3fb.js"><link rel="prefetch" href="/assets/js/22.15590b81.js"><link rel="prefetch" href="/assets/js/23.7f6f516f.js"><link rel="prefetch" href="/assets/js/24.cec54b5f.js"><link rel="prefetch" href="/assets/js/25.ea311ad3.js"><link rel="prefetch" href="/assets/js/26.99048ba1.js"><link rel="prefetch" href="/assets/js/27.d12bbb8f.js"><link rel="prefetch" href="/assets/js/28.a372bebb.js"><link rel="prefetch" href="/assets/js/29.30008c17.js"><link rel="prefetch" href="/assets/js/3.54c41fbc.js"><link rel="prefetch" href="/assets/js/30.b3b21664.js"><link rel="prefetch" href="/assets/js/31.852629b4.js"><link rel="prefetch" href="/assets/js/32.63ddb66f.js"><link rel="prefetch" href="/assets/js/33.b033dd94.js"><link rel="prefetch" href="/assets/js/34.8eba19a6.js"><link rel="prefetch" href="/assets/js/35.072214e9.js"><link rel="prefetch" href="/assets/js/36.0c59dada.js"><link rel="prefetch" href="/assets/js/37.d74a4643.js"><link rel="prefetch" href="/assets/js/38.476fb399.js"><link rel="prefetch" href="/assets/js/39.74b96d60.js"><link rel="prefetch" href="/assets/js/4.9974a208.js"><link rel="prefetch" href="/assets/js/40.fd567cbe.js"><link rel="prefetch" href="/assets/js/41.41f16031.js"><link rel="prefetch" href="/assets/js/5.a26a4e76.js"><link rel="prefetch" href="/assets/js/6.b30bd559.js"><link rel="prefetch" href="/assets/js/7.6db50ac1.js"><link rel="prefetch" href="/assets/js/8.48a961d9.js"><link rel="prefetch" href="/assets/js/9.97de75f5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8d0c462e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">木子吻雨叚</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/english/introduction.html" class="nav-link">英文阅读</a></div><div class="nav-item"><a href="/note/introduction.html" class="nav-link">笔记</a></div><div class="nav-item"><a href="/extend-piecemeal/introduction.html" class="nav-link">拓展&amp;零碎</a></div><div class="nav-item"><a href="/vue/introduction.html" class="nav-link">vue</a></div><div class="nav-item"><a href="/js/introduction.html" class="nav-link">js</a></div><div class="nav-item"><a href="/interview/introduction.html" class="nav-link">面试</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/english/introduction.html" class="nav-link">英文阅读</a></div><div class="nav-item"><a href="/note/introduction.html" class="nav-link">笔记</a></div><div class="nav-item"><a href="/extend-piecemeal/introduction.html" class="nav-link">拓展&amp;零碎</a></div><div class="nav-item"><a href="/vue/introduction.html" class="nav-link">vue</a></div><div class="nav-item"><a href="/js/introduction.html" class="nav-link">js</a></div><div class="nav-item"><a href="/interview/introduction.html" class="nav-link">面试</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/introduction.html" class="sidebar-link">导读</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>es6</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/note/es6/es6.html" class="sidebar-link">es6</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>react</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/note/react/react.html" class="sidebar-link">react</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>taro</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/note/taro/cropper.html" class="sidebar-link">/note/taro/cropper.html</a></li><li><a href="/note/taro/image-cropper.html" class="sidebar-link">/note/taro/image-cropper.html</a></li><li><a href="/note/taro/taro.html" class="sidebar-link">taro</a></li><li><a href="/note/taro/taro问题汇总.html" class="sidebar-link">taro3.0包体积过大问题</a></li><li><a href="/note/taro/updata.html" class="sidebar-link">/note/taro/updata.html</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>vite</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/note/vite/vite.html" class="active sidebar-link">搭建第一个vite项目 vite</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/vite/vite.html#vite配置文件vite-config-js" class="sidebar-link">vite配置文件vite.config.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/vite/vite.html#base-基础路径" class="sidebar-link">base 基础路径</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#resolve-alias-alias-路径别名" class="sidebar-link">resolve.alias (alias 路径别名)</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#生产环境移除console-log配置build-terseroptions" class="sidebar-link">生产环境移除console.log配置build.terserOptions</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#输出文件配置-build-rollupoptions" class="sidebar-link">输出文件配置 build.rollupOptions</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#mock配置" class="sidebar-link">mock配置</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#proxy配置前端跨域代理" class="sidebar-link">proxy配置前端跨域代理</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#env环境变量配置" class="sidebar-link">env环境变量配置</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#cdn打包配置" class="sidebar-link">cdn打包配置</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#gzip代码压缩配置" class="sidebar-link">gzip代码压缩配置</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#图片压缩打包" class="sidebar-link">图片压缩打包</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#eslint-prettier-代码格式配置" class="sidebar-link">eslint,prettier 代码格式配置</a></li><li class="sidebar-sub-header"><a href="/note/vite/vite.html#vscode共享配置" class="sidebar-link">vscode共享配置</a></li></ul></li></ul></li><li><a href="/note/vite/vite2.html" class="sidebar-link">前端杨村长创建vite项目</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h3 id="搭建第一个vite项目-vite"><a href="#搭建第一个vite项目-vite" aria-hidden="true" class="header-anchor">#</a> 搭建第一个vite项目 <a href="https://vitejs.cn/guide/#scaffolding-your-first-vite-project" target="_blank" rel="noopener noreferrer">vite<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <div class="language-js extra-class"><pre class="language-js"><code>$ npm init vite@latest
or
$ yarn create vite
or
$ pnpm create vite
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>npx degit user<span class="token operator">/</span>project my<span class="token operator">-</span>project
cd my<span class="token operator">-</span>project

npm install
npm run dev
</code></pre></div><h2 id="vite配置文件vite-config-js"><a href="#vite配置文件vite-config-js" aria-hidden="true" class="header-anchor">#</a> vite配置文件vite.config.js</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&quot;@vitejs/plugin-vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="base-基础路径"><a href="#base-基础路径" aria-hidden="true" class="header-anchor">#</a> base 基础路径</h3> <p>开发和生产环境的公共基础路径<br>
-绝对路径<br>
-相对路径<br>
-完整路径<br>
以斜杠开头，如果在linux服务器上存在一个隐患，以/root开头，就是不知道能不能访问到，所以配置一个基础路径</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&quot;@vitejs/plugin-vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  base<span class="token punctuation">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>配置前路径：&quot;/src/assets/logo.png&quot;<br>
配置后路径：&quot;./assets/logo.png&quot;</p> <h3 id="resolve-alias-alias-路径别名"><a href="#resolve-alias-alias-路径别名" aria-hidden="true" class="header-anchor">#</a> resolve.alias (alias 路径别名)</h3> <p><strong>resolve.alias</strong>是和base同级别的resolve对象下的alias配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&quot;@vitejs/plugin-vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 添加引入resolve，path.resolve() 方法会把一个路径或路径片段的序列解析为一个绝对路径。</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  base<span class="token punctuation">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span><span class="token punctuation">{</span>
    alias<span class="token punctuation">:</span><span class="token punctuation">{</span>
      comp<span class="token punctuation">:</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'/src/components'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//__dirname项目的绝对路径，</span>
      <span class="token string">&quot;/icon&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;./src/assets&quot;</span><span class="token punctuation">,</span><span class="token comment">//静态文件添加 例如：icon，不能使用resolve的方式</span>
      <span class="token comment">// icon:resolve(__dirname,'/src/assets'), //* 坑！！！ 开发模式图片不显示,报错 http://localhost:3000/icon/logo.png 404 (Not Found)，打包OK</span>
      
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用方式:<br>
组件引入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">&quot;./components/HelloWorld.vue&quot;</span><span class="token punctuation">;</span><span class="token comment">//before 使用相对路径</span>
<span class="token keyword">import</span> hi <span class="token keyword">from</span> <span class="token string">&quot;comp/hi.vue&quot;</span><span class="token punctuation">;</span><span class="token comment">//after 使用绝对路径</span>
</code></pre></div><p>图标引入</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Vue logo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./assets/logo.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!--before --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Vue logo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/icon/logo.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!--after --&gt;</span>
</code></pre></div><h3 id="生产环境移除console-log配置build-terseroptions"><a href="#生产环境移除console-log配置build-terseroptions" aria-hidden="true" class="header-anchor">#</a> 生产环境移除console.log配置build.terserOptions</h3> <p>开发环境的console.log没有清除，生产环境配置不显示出来 <a href="https://terser.org/docs/api-reference#minify-options" target="_blank" rel="noopener noreferrer">drop_console<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//vite.config.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  base<span class="token punctuation">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span><span class="token punctuation">{</span>
    alias<span class="token punctuation">:</span><span class="token punctuation">{</span>
      comp<span class="token punctuation">:</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'/src/components'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;/icon&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;./src/assets&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  build<span class="token punctuation">:</span><span class="token punctuation">{</span>
    minify<span class="token punctuation">:</span> <span class="token string">&quot;terser&quot;</span><span class="token punctuation">,</span><span class="token comment">//默认为esbuild，* 坑！！！ terserOptions必须配置为terser才起作用</span>
    terserOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 生产环境时清除console.log</span>
        drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 生产环境时清除debugger语句</span>
        drop_debugger<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="输出文件配置-build-rollupoptions"><a href="#输出文件配置-build-rollupoptions" aria-hidden="true" class="header-anchor">#</a> 输出文件配置 build.rollupOptions</h3> <p><strong>rollupOptions.output</strong><br>
配置前打包，img,css,js混合在assets文件下<br>
配置后打包，静态文件按照文件后缀分类</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//vite.config.js</span>
build<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minify<span class="token punctuation">:</span> <span class="token string">&quot;terser&quot;</span><span class="token punctuation">,</span>
    terserOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        drop_debugger<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    rollupOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        chunkFileNames<span class="token punctuation">:</span> <span class="token string">&quot;assets/js/[name]-[hash].js&quot;</span><span class="token punctuation">,</span><span class="token comment">//出口文件 assets-&gt;js</span>
        entryFileNames<span class="token punctuation">:</span> <span class="token string">&quot;assets/js/[name]-[hash].js&quot;</span><span class="token punctuation">,</span><span class="token comment">//如口文件</span>
        assetFileNames<span class="token punctuation">:</span> <span class="token string">&quot;assets/[ext]/[name]-[hash].[ext]&quot;</span><span class="token punctuation">,</span><span class="token comment">//静态文件 [ext]以文件后缀分类文件夹</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="mock配置"><a href="#mock配置" aria-hidden="true" class="header-anchor">#</a> mock配置</h3> <p>1、安装mockjs</p> <p>node version: &gt;=12.0.0<br>
vite version: &gt;=2.0.0</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add mockjs
# or
npm i  mockjs <span class="token operator">-</span><span class="token constant">S</span>
</code></pre></div><p>2、安装 <a href="https://www.npmjs.com/package/vite-plugin-mock" target="_blank" rel="noopener noreferrer">vite-plugin-mock<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add vite<span class="token operator">-</span>plugin<span class="token operator">-</span>mock <span class="token operator">-</span><span class="token constant">D</span>
# or
npm i vite<span class="token operator">-</span>plugin<span class="token operator">-</span>mock <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>3、安装axios</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add axios
</code></pre></div><p>4、配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> viteMockServe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-mock&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  base<span class="token punctuation">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">viteMockServe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// default</span>
      mockPath<span class="token punctuation">:</span> <span class="token string">&quot;mock&quot;</span><span class="token punctuation">,</span><span class="token comment">// 类型： string；默认： 'mock'；设置存储模拟 .ts 文件的文件夹；如果watchFiles:true，则将监视文件夹中的文件更改。并实时同步到请求结果；如果 configPath 有值，则无效</span>
      <span class="token comment">// localEnabled: command === 'serve',//（不需要）本地启用；类型： boolean；默认： command === 'serve'；设置是否开启本地mock .ts文件，不要在生产环境打开</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>5、根目录下新建mock文件夹，新建index.ts文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MockMethod <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite-plugin-mock'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> <span class="token string">'/api/get'</span><span class="token punctuation">,</span>
    method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">response</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> query <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">'vben'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span> <span class="token keyword">as</span> MockMethod<span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre></div><p>6、使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/get&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{code:0,data:{name:&quot;vben&quot;}}</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="proxy配置前端跨域代理"><a href="#proxy配置前端跨域代理" aria-hidden="true" class="header-anchor">#</a> proxy配置前端跨域代理</h3> <p><strong>server.proxy</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  base<span class="token punctuation">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">viteMockServe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// default</span>
      mockPath<span class="token punctuation">:</span> <span class="token string">&quot;mock&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      comp<span class="token punctuation">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src/components&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;/icon&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;./src/assets&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  build<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minify<span class="token punctuation">:</span> <span class="token string">&quot;terser&quot;</span><span class="token punctuation">,</span>
    terserOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      compress<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 生产环境时清除console.log</span>
        drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 生产环境时清除debugger语句</span>
        drop_debugger<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    rollupOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        chunkFileNames<span class="token punctuation">:</span> <span class="token string">&quot;assets/js/[name]-[hash].js&quot;</span><span class="token punctuation">,</span>
        entryFileNames<span class="token punctuation">:</span> <span class="token string">&quot;assets/js/[name]-[hash].js&quot;</span><span class="token punctuation">,</span>
        assetFileNames<span class="token punctuation">:</span> <span class="token string">&quot;assets/[ext]/[name]-[hash].[ext]&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  server<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 三种写法</span>
      <span class="token comment">// 选项写法，/req可自定义</span>
      <span class="token string">&quot;/req&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">&quot;http://home-user-api.ahdev.guahao-test.com&quot;</span><span class="token punctuation">,</span><span class="token comment">//跨域域名</span>
        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">rewrite</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\/req/</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//匹配到/req开头，就替换掉</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 正则表达式写法</span>
      <span class="token string">&quot;^/fallback/.*&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">&quot;http://home-user-api.ahdev.guahao-test.com&quot;</span><span class="token punctuation">,</span>
        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">rewrite</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\/fallback/</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 使用 proxy 实例</span>
      <span class="token string">&quot;/ss&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">&quot;http://home-user-api.ahdev.guahao-test.com&quot;</span><span class="token punctuation">,</span>
        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">configure</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">proxy<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;--&quot;</span><span class="token punctuation">,</span> proxy<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// proxy 是 'http-proxy' 的实例</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 没有跨域问题</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/get&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{code:0,data:{name:&quot;vben&quot;}}</span>

  <span class="token comment">// 跨域</span>
  <span class="token comment">// const data1 = await axios.get(&quot;http://home-user-api.ahdev.guahao-test.com&quot;);</span>
  <span class="token comment">// console.log(data1);</span>

  <span class="token comment">// 使用代理</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/req&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="env环境变量配置"><a href="#env环境变量配置" aria-hidden="true" class="header-anchor">#</a> env环境变量配置</h3> <p>根目录新建 <strong>.env.development</strong> 和 <strong>.env.production</strong> 文件<br> <a href="https://vitejs.cn/guide/env-and-mode.html#env-files" target="_blank" rel="noopener noreferrer">.evn<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
加载的环境变量通过 <strong>import.meta.env</strong> 暴露给客户端源码<br>
变量名只能以 <strong>VITE_</strong> 为前缀，为了防止意外地将一些环境变量泄漏到客户端</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .env.development</span>
<span class="token comment">//自定义字段名VITE_BASE_URL</span>
<span class="token comment">// /api/get 本地mock接口地址</span>
<span class="token constant">VITE_BASE_URL</span><span class="token operator">=</span><span class="token operator">/</span>api<span class="token operator">/</span><span class="token keyword">get</span>  
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .env.production</span>
<span class="token comment">// /api/get 本地mock接口地址</span>
<span class="token constant">VITE_BASE_URL</span><span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>home<span class="token operator">-</span>user<span class="token operator">-</span>api<span class="token punctuation">.</span>ahdev<span class="token punctuation">.</span>guahao<span class="token operator">-</span>test<span class="token punctuation">.</span>com <span class="token comment">//1、无需跨域，正式域名</span>
<span class="token constant">VITE_BASE_URL</span><span class="token operator">=</span><span class="token operator">/</span>req <span class="token comment">//2、域名跨域，使用代理</span>
</code></pre></div><p>使用</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data3 <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_BASE_URL</span><span class="token punctuation">,</span> data3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="cdn打包配置"><a href="#cdn打包配置" aria-hidden="true" class="header-anchor">#</a> cdn打包配置</h3> <p>配置cdn打包的意义在于开发环境下按照正常的开发步骤去走。但是一旦打包，则走的是CDN的形式，仅打包element-plus的使用模块包。<br>
element-plus全局引入打包前体积约为700多kb，太大了，但是按需引入，打包时间太久，所以使用cdn配置打包，仅打包已使用，打包后为15kb（使用的模块越多越大），打包速度也快<br>
打包前:<br> <img src="/assets/img/cdn1.1dfb41a9.jpg" alt="An image"><br>
打包后:<br> <img src="/assets/img/cdn2.93db89f9.jpg" alt="An image"></p> <p>安装 <a href="https://github.com/MMF-FE/vite-plugin-cdn-import/issues/14" target="_blank" rel="noopener noreferrer">vite-plugin-cdn-import<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code>npm install vite<span class="token operator">-</span>plugin<span class="token operator">-</span>cdn<span class="token operator">-</span><span class="token keyword">import</span> <span class="token operator">--</span>save<span class="token operator">-</span>dev

or yarn

yarn add vite<span class="token operator">-</span>plugin<span class="token operator">-</span>cdn<span class="token operator">-</span><span class="token keyword">import</span> <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p><a href="https://element-plus.gitee.io/zh-CN/guide/installation.html#unpkg" target="_blank" rel="noopener noreferrer">element-plus引入路径查找<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> importToCDN <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-cdn-import&quot;</span><span class="token punctuation">;</span>

 plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">importToCDN</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      modules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token comment">//需要将vue也配置，按照官网上的配置会有问题，</span>
          <span class="token keyword">var</span><span class="token punctuation">:</span> <span class="token string">&quot;Vue&quot;</span><span class="token punctuation">,</span>
          path<span class="token punctuation">:</span> <span class="token string">&quot;https://unpkg.com/vue@next&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">&quot;element-plus&quot;</span><span class="token punctuation">,</span> <span class="token comment">//配置element-plus</span>
          <span class="token keyword">var</span><span class="token punctuation">:</span> <span class="token string">&quot;ElementPlus&quot;</span><span class="token punctuation">,</span>
          path<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`https://unpkg.com/element-plus`</span></span><span class="token punctuation">,</span>
          css<span class="token punctuation">:</span> <span class="token string">&quot;https://unpkg.com/element-plus/dist/index.css&quot;</span><span class="token punctuation">,</span><span class="token comment">//此处引入css后，main.js中不用引入</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="gzip代码压缩配置"><a href="#gzip代码压缩配置" aria-hidden="true" class="header-anchor">#</a> gzip代码压缩配置</h3> <p>上一步cdn打包后压缩至15kb,通过gzip压缩后为5.57kb<br> <img src="/assets/img/gzip.c74d6419.jpg" alt="An image"></p> <p>安装<a href="https://github.com/vbenjs/vite-plugin-compression" target="_blank" rel="noopener noreferrer">vite-plugin-compression<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// node version: &gt;=12.0.0</span>
<span class="token comment">// vite version: &gt;=2.0.0</span>

yarn add vite<span class="token operator">-</span>plugin<span class="token operator">-</span>compression <span class="token operator">-</span><span class="token constant">D</span>
or
npm i vite<span class="token operator">-</span>plugin<span class="token operator">-</span>compression <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>

<span class="token keyword">import</span> viteCompression <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-compression&quot;</span><span class="token punctuation">;</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">viteCompression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//配置gzip</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// 其它配置项</span>
<span class="token comment">// viteCompression({</span>
<span class="token comment">//     verbose: true,</span>
<span class="token comment">//     disable: false,</span>
<span class="token comment">//     threshold: 10240,</span>
<span class="token comment">//     algorithm: &quot;gzip&quot;,</span>
<span class="token comment">//     ext: &quot;gz&quot;,</span>
<span class="token comment">// }),</span>
</code></pre></div><h3 id="图片压缩打包"><a href="#图片压缩打包" aria-hidden="true" class="header-anchor">#</a> 图片压缩打包</h3> <p>安装 <a href="https://github.com/vbenjs/vite-plugin-imagemin" target="_blank" rel="noopener noreferrer">vite-plugin-imagemin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
node version: &gt;=12.20.0<br>
vite version: &gt;=2.0.0</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add vite<span class="token operator">-</span>plugin<span class="token operator">-</span>imagemin <span class="token operator">-</span><span class="token constant">D</span>
or
npm i vite<span class="token operator">-</span>plugin<span class="token operator">-</span>imagemin <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> viteImagemin <span class="token keyword">from</span> <span class="token string">'vite-plugin-imagemin'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token function">viteImagemin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        gifsicle<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          optimizationLevel<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
          interlaced<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        optipng<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          optimizationLevel<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        mozjpeg<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          quality<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        pngquant<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          quality<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          speed<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        svgo<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string">'removeViewBox'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string">'removeEmptyAttrs'</span><span class="token punctuation">,</span>
              active<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="eslint-prettier-代码格式配置"><a href="#eslint-prettier-代码格式配置" aria-hidden="true" class="header-anchor">#</a> eslint,prettier 代码格式配置</h3> <p><img src="/assets/img/eslintrc-prettier.dbc916e2.jpg" alt="An image"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 待补充</span>
</code></pre></div><p>新建.eslintrc.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .eslintrc.js</span>
<span class="token comment">// 待补充</span>
</code></pre></div><p>新建.prettier.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .prettier.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  printWidth<span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">//单行长度</span>
  tabWidth<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">//缩进长度</span>
  useTabs<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//使用空格代替tab缩进</span>
  semi<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//句末使用分号</span>
  singleQuote<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//使用单引号</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="vscode共享配置"><a href="#vscode共享配置" aria-hidden="true" class="header-anchor">#</a> vscode共享配置</h3> <p>.vscode执行文件，新建项目默认生成<br>
.vscode下文件extensions.json 是建议安装的扩展文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// extensions.json</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;recommendations&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;johnsoncodehk.volar&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//推荐使用的插件列表，例：在vscode插件中搜索johnsoncodehk.volar安装使用</span>
<span class="token punctuation">}</span>

</code></pre></div><p>下载github上的文件，如果有多个推荐使用的扩展插件<br> <strong>简便方法：vscode扩展插件中选择筛选，筛选条件是推荐，可一次性预览，未安装的可选择安装</strong></p> <p>新建settings.json配置文件，同步代码规范，减少代码冲突，优先于本地settings</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// settings.json</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;editor.tabSize&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">&quot;html.format.wrapLineLength&quot;</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token comment">//html文本长度</span>
    <span class="token string">&quot;editor.detectIndentation&quot;</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string">&quot;files.exclude&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;dist&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;cypress&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;package-lock.json&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;beautify.config&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;brace_style&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;collapse,preserve-inline&quot;</span> <span class="token comment">//大括号自动换行问题</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;editor.mouseWheelZoom&quot;</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string">&quot;eslint.validate&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;javascriptreact&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;html&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;vue&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;editor.codeActionsOnSave&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;source.fixAll.eslint&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2/28/2022, 6:35:42 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/note/taro/updata.html" class="prev">
          /note/taro/updata.html
        </a></span> <span class="next"><a href="/note/vite/vite2.html">
          前端杨村长创建vite项目
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.7f183510.js" defer></script><script src="/assets/js/2.3fefde55.js" defer></script>
  </body>
</html>
